<app-default-layout>
    <div class="page-content">
        <div class="index-tool-container">
            <button matButton="filled" (click)="openEditor()">
                <mat-icon>add</mat-icon>
                Create New 
            </button>
            @if(deleteButton()){
                <button matButton="filled">
                    <mat-icon>delete</mat-icon>
                    Delete Selected
                </button>
            }
        </div>
        <div class="table-container">
            <app-data-table 
                [loading]="loading()"
                [data]="data()" 
                [actionTemplate]="actionTemplate" 
                [showSelection]="true" 
                [columns]="['id', 'title', 'tag', 'author', 'date']"
                [columnTemplates]="{ tag: tagTemplate }"
                (selectionChange)="onSelectionChange($event)"
            />
            <ng-template #tagTemplate let-row let-value="value">
                @for(tag of getTagContent(value); track tag){
                    <mat-chip >{{tag}}</mat-chip>
                }
            </ng-template>
            <ng-template #actionTemplate let-row>
                <button 
                    matIconButton 
                    (click)="edit(row)"
                    matTooltip="Edit this article."
                >
                    <mat-icon>edit</mat-icon>
                </button>
            </ng-template>
            
        </div>
        <div class="paginator-container">
            <mat-paginator 
                [length]="100"
                [pageSize]="10"
                [pageSizeOptions]="[5, 10, 25, 100]"
                aria-label="Select page">
            </mat-paginator>
        </div>
    </div>

    <app-article-editor
        [article]="selectedArticle"
        [open]="editForm()"
        (save)="onSave($event)"
        (cancel)="onCancel()"
    />
</app-default-layout>